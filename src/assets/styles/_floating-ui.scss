$floating-ui-transform-bottom: translateY(-5px);
$floating-ui-transform-top: translateY(5px);
$floating-ui-transform-left: translateX(5px);
$floating-ui-transform-right: translateX(-5px);

:root {
  --calcite-floating-ui-transition: var(--calcite-animation-timing);
  --calcite-floating-ui-z-index: theme("zIndex.dropdown");
}

@mixin floatingUIAnim {
  .calcite-floating-ui-anim {
    position: relative;
    transition: var(--calcite-floating-ui-transition);
    transition-property: transform, visibility, opacity;
    opacity: 0;
    box-shadow: $shadow-2;
    @apply rounded z-default;
  }
}

@mixin floatingUIAnimActive {
  opacity: 1;
  transform: translate(0);
}

@mixin floatingUIElemAnim($selector) {
  #{$selector} {
    @include floatingUIAnim();

    &[data-placement^="bottom"] .calcite-floating-ui-anim {
      transform: $floating-ui-transform-bottom;
    }

    &[data-placement^="top"] .calcite-floating-ui-anim {
      transform: $floating-ui-transform-top;
    }

    &[data-placement^="left"] .calcite-floating-ui-anim {
      transform: $floating-ui-transform-left;
    }

    &[data-placement^="right"] .calcite-floating-ui-anim {
      transform: $floating-ui-transform-right;
    }

    &[data-placement] .calcite-floating-ui-anim--active {
      @include floatingUIAnimActive();
    }
  }
}

@mixin floatingUIHostAnim {
  @include floatingUIAnim();

  :host([data-placement^="bottom"]) .calcite-floating-ui-anim {
    transform: $floating-ui-transform-bottom;
  }

  :host([data-placement^="top"]) .calcite-floating-ui-anim {
    transform: $floating-ui-transform-top;
  }

  :host([data-placement^="left"]) .calcite-floating-ui-anim {
    transform: $floating-ui-transform-left;
  }

  :host([data-placement^="right"]) .calcite-floating-ui-anim {
    transform: $floating-ui-transform-right;
  }

  :host([data-placement]) .calcite-floating-ui-anim--active {
    @include floatingUIAnimActive();
  }
}

@mixin floatingUIContainer() {
  display: block;
  position: absolute;
  z-index: var(--calcite-floating-ui-z-index);
}

@mixin floatingUIWrapper {
  visibility: hidden;
}

@mixin floatingUIWrapperActive {
  visibility: visible;
}

@mixin floatingUIHost() {
  :host {
    @include floatingUIContainer();
  }

  @include floatingUIHostAnim();

  @include calciteHydratedHidden();
}

$pointer_size: 12px;
$pointer_offset: -$pointer_size * 0.5;

@mixin floatingUIArrow {
  .arrow,
  .arrow::before {
    position: absolute;
    inline-size: $pointer_size;
    block-size: $pointer_size;
    @apply -z-default;
  }

  .arrow::before {
    content: "";
    background: var(--calcite-ui-foreground-1);
  }

  :host([data-placement^="top"]) .arrow {
    inset-block-end: $pointer_offset;
  }

  :host([data-placement^="top"]) .arrow::before {
    clip-path: polygon(50% 100%, 0 50%, 100% 50%);
  }

  :host([data-placement^="bottom"]) .arrow {
    inset-block-start: $pointer_offset;
  }

  :host([data-placement^="bottom"]) .arrow::before {
    clip-path: polygon(50% 0, 0 50%, 100% 50%);
  }

  :host([data-placement^="right"]) .arrow,
  :host([data-placement^="left"]) .arrow {
    direction: ltr;
    text-align: start;
  }

  :host([data-placement^="left"]) .arrow {
    inset-inline-end: $pointer_offset;
  }

  :host([data-placement^="left"]) .arrow::before {
    clip-path: polygon(100% 50%, 50% 0, 50% 100%);
  }

  :host([data-placement^="right"]) .arrow {
    inset-inline-start: $pointer_offset;
  }

  :host([data-placement^="right"]) .arrow::before {
    clip-path: polygon(0 50%, 50% 0, 50% 100%);
  }
}
