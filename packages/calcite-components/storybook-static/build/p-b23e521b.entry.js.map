{"version":3,"names":["CSS","thumbnail","background","initials","icon","stringToHex","string","mixStringDeterministically","hash","i","length","charCodeAt","hex","j","value","toString","substr","midPoint","Math","floor","reversed","split","reverse","join","substring","slice","rgbToHue","rgb","r","g","b","max","min","delta","hue","round","hexToHue","hexToRGB","avatarCss","CalciteAvatarStyle0","Avatar","render","this","determineContent","thumbnailFailedToLoad","h","alt","label","class","onError","src","generateInitials","backgroundColor","generateFillColor","fullName","role","style","scale","userId","username","el","theme","getModeName","id","name","isValidHex","l","trim","map"],"sources":["src/components/avatar/resources.ts","src/components/avatar/utils.ts","src/components/avatar/avatar.scss?tag=calcite-avatar&encapsulation=shadow","src/components/avatar/avatar.tsx"],"sourcesContent":["export const CSS = {\n  thumbnail: \"thumbnail\",\n  background: \"background\",\n  initials: \"initials\",\n  icon: \"icon\",\n};\n","import { RGB } from \"../color-picker/interfaces\";\nimport { hexToRGB } from \"../color-picker/utils\";\n\n/**\n * Convert a string to a valid hex by hashing its contents\n * and using the hash as a seed for three distinct color values\n *\n * @param string\n */\nexport function stringToHex(string: string): string {\n  // improve random color generation for similar strings.\n  string = mixStringDeterministically(string);\n\n  let hash = 0;\n  for (let i = 0; i < string.length; i++) {\n    hash = string.charCodeAt(i) + ((hash << 5) - hash);\n  }\n\n  let hex = \"#\";\n  for (let j = 0; j < 3; j++) {\n    const value = (hash >> (j * 8)) & 0xff;\n    hex += (\"00\" + value.toString(16)).substr(-2);\n  }\n  return hex;\n}\n\n/**\n * The function splits the string into two halves, reverses each half, and then concatenates them.\n *\n * @param {string} string - The input string to be mixed.\n * @returns {string} - The mixed string.\n */\nfunction mixStringDeterministically(string: string): string {\n  const midPoint = Math.floor(string.length / 2);\n  const reversed = string.split(\"\").reverse().join(\"\");\n  return reversed.substring(midPoint) + reversed.slice(0, midPoint);\n}\n\n/**\n * Find the hue of a color given the separate RGB color channels\n *\n * @param rgb\n */\nexport function rgbToHue(rgb: RGB): number {\n  let { r, g, b } = rgb;\n  r /= 255;\n  g /= 255;\n  b /= 255;\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  const delta = max - min;\n\n  if (max === min) {\n    return 0;\n  }\n\n  let hue = (max + min) / 2;\n  switch (max) {\n    case r:\n      hue = (g - b) / delta + (g < b ? 6 : 0);\n      break;\n    case g:\n      hue = (b - r) / delta + 2;\n      break;\n    case b:\n      hue = (r - g) / delta + 4;\n      break;\n  }\n\n  return Math.round(hue * 60);\n}\n\n/**\n * For a hex color, find the hue\n *\n * @param hex {string} - form of \"#------\"\n */\nexport function hexToHue(hex: string): number {\n  return rgbToHue(hexToRGB(hex));\n}\n","/**\n * CSS Custom Properties\n *\n * These properties can be overridden using the component's tag as selector.\n *\n * @prop --calcite-avatar-corner-radius: defines the corner radius of the component.\n * @prop --calcite-avatar-text-color: defines the text color of the component.\n * @prop --calcite-avatar-icon-color: defines the icon color of the component.\n *\n */\n\n:host {\n  @apply inline-block overflow-hidden;\n}\n\n:host,\n.background,\n.thumbnail {\n  border-radius: var(--calcite-avatar-corner-radius, 50%);\n}\n\n.background,\n.thumbnail {\n  block-size: var(--calcite-container-size-content-fluid);\n  inline-size: var(--calcite-container-size-content-fluid);\n}\n\n.icon,\n.background {\n  @apply flex;\n}\n\n.background {\n  @apply items-center justify-center;\n}\n\n.icon {\n  --calcite-icon-color: var(--calcite-avatar-icon-color, var(--calcite-avatar-text-color, var(--calcite-color-text-2)));\n}\n\n.initials {\n  @apply font-bold uppercase;\n  color: var(--calcite-avatar-text-color, var(--calcite-color-text-2));\n}\n\n:host([scale=\"s\"]) {\n  @apply text-n3 h-6 w-6;\n}\n\n:host([scale=\"m\"]) {\n  @apply text-n2 h-8 w-8;\n}\n\n:host([scale=\"l\"]) {\n  @apply text-0 h-11 w-11;\n}\n\n@include base-component();\n","import { Component, Element, h, Prop, State } from \"@stencil/core\";\nimport { getModeName } from \"../../utils/dom\";\nimport { isValidHex } from \"../color-picker/utils\";\nimport { Scale } from \"../interfaces\";\nimport { CSS } from \"./resources\";\nimport { hexToHue, stringToHex } from \"./utils\";\n\n@Component({\n  tag: \"calcite-avatar\",\n  styleUrl: \"avatar.scss\",\n  shadow: true,\n})\nexport class Avatar {\n  //--------------------------------------------------------------------------\n  //\n  //  Properties\n  //\n  //--------------------------------------------------------------------------\n\n  /** Specifies the size of the component. */\n  @Prop({ reflect: true }) scale: Scale = \"m\";\n\n  /** Specifies the `src` to an image (remember to add a token if the user is private). */\n  @Prop({ reflect: true }) thumbnail: string;\n\n  /** Specifies the full name of the user. When `label` and `thumbnail` are not defined, specifies the accessible name for the component. */\n  @Prop({ reflect: true }) fullName: string;\n\n  /** Specifies the username of the user. */\n  @Prop({ reflect: true }) username: string;\n\n  /** Specifies the unique id of the user. */\n  @Prop({ reflect: true }) userId: string;\n\n  /** Specifies alternative text when `thumbnail` is defined, otherwise specifies an accessible label.*/\n  @Prop() label: string;\n\n  //--------------------------------------------------------------------------\n  //\n  //  Lifecycle\n  //\n  //--------------------------------------------------------------------------\n\n  render() {\n    return this.determineContent();\n  }\n\n  //--------------------------------------------------------------------------\n  //\n  //  Private State/Props\n  //\n  //--------------------------------------------------------------------------\n\n  @Element() el: HTMLCalciteAvatarElement;\n\n  @State() thumbnailFailedToLoad = false;\n\n  //--------------------------------------------------------------------------\n  //\n  //  Private Methods\n  //\n  //--------------------------------------------------------------------------\n\n  private determineContent() {\n    if (this.thumbnail && !this.thumbnailFailedToLoad) {\n      return (\n        <img\n          alt={this.label || \"\"}\n          class={CSS.thumbnail}\n          onError={() => (this.thumbnailFailedToLoad = true)}\n          src={this.thumbnail}\n        />\n      );\n    }\n    const initials = this.generateInitials();\n    const backgroundColor = this.generateFillColor();\n    return (\n      <span\n        aria-label={this.label || this.fullName}\n        class={CSS.background}\n        role=\"figure\"\n        style={{ backgroundColor }}\n      >\n        {initials ? (\n          <span aria-hidden=\"true\" class={CSS.initials}>\n            {initials}\n          </span>\n        ) : (\n          <calcite-icon class={CSS.icon} icon=\"user\" scale={this.scale} />\n        )}\n      </span>\n    );\n  }\n\n  /**\n   * Generate a valid background color that is consistent and unique to this user\n   */\n  private generateFillColor() {\n    const { userId, username, fullName, el } = this;\n    const theme = getModeName(el);\n    const id = userId && `#${userId.substr(userId.length - 6)}`;\n    const name = username || fullName || \"\";\n    const hex = id && isValidHex(id) ? id : stringToHex(name);\n    // if there is not unique information, or an invalid hex is produced, return a default\n    if ((!userId && !name) || !isValidHex(hex)) {\n      return `var(--calcite-color-foreground-2)`;\n    }\n    const hue = hexToHue(hex);\n    const l = theme === \"dark\" ? 20 : 90;\n    return `hsl(${hue}, 60%, ${l}%)`;\n  }\n\n  /**\n   * Use fullName or username to generate initials\n   */\n  private generateInitials(): string | boolean {\n    const { fullName, username } = this;\n    if (fullName) {\n      return fullName\n        .trim()\n        .split(\" \")\n        .map((name) => name.substring(0, 1))\n        .join(\"\");\n    } else if (username) {\n      return username.substring(0, 2);\n    }\n    return false;\n  }\n}\n"],"mappings":";;;;;iLAAO,MAAMA,EAAM,CACjBC,UAAW,YACXC,WAAY,aACZC,SAAU,WACVC,KAAM,Q,SCKQC,EAAYC,GAE1BA,EAASC,EAA2BD,GAEpC,IAAIE,EAAO,EACX,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAOI,OAAQD,IAAK,CACtCD,EAAOF,EAAOK,WAAWF,KAAOD,GAAQ,GAAKA,E,CAG/C,IAAII,EAAM,IACV,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAMC,EAASN,GAASK,EAAI,EAAM,IAClCD,IAAQ,KAAOE,EAAMC,SAAS,KAAKC,QAAQ,E,CAE7C,OAAOJ,CACT,CAQA,SAASL,EAA2BD,GAClC,MAAMW,EAAWC,KAAKC,MAAMb,EAAOI,OAAS,GAC5C,MAAMU,EAAWd,EAAOe,MAAM,IAAIC,UAAUC,KAAK,IACjD,OAAOH,EAASI,UAAUP,GAAYG,EAASK,MAAM,EAAGR,EAC1D,C,SAOgBS,EAASC,GACvB,IAAIC,EAAEA,EAACC,EAAEA,EAACC,EAAEA,GAAMH,EAClBC,GAAK,IACLC,GAAK,IACLC,GAAK,IACL,MAAMC,EAAMb,KAAKa,IAAIH,EAAGC,EAAGC,GAC3B,MAAME,EAAMd,KAAKc,IAAIJ,EAAGC,EAAGC,GAC3B,MAAMG,EAAQF,EAAMC,EAEpB,GAAID,IAAQC,EAAK,CACf,OAAO,C,CAGT,IAAIE,GAAOH,EAAMC,GAAO,EACxB,OAAQD,GACN,KAAKH,EACHM,GAAOL,EAAIC,GAAKG,GAASJ,EAAIC,EAAI,EAAI,GACrC,MACF,KAAKD,EACHK,GAAOJ,EAAIF,GAAKK,EAAQ,EACxB,MACF,KAAKH,EACHI,GAAON,EAAIC,GAAKI,EAAQ,EACxB,MAGJ,OAAOf,KAAKiB,MAAMD,EAAM,GAC1B,C,SAOgBE,EAASxB,GACvB,OAAOc,EAASW,EAASzB,GAC3B,CC/EA,MAAM0B,EAAY,+6BAClB,MAAAC,EAAeD,E,MCWFE,EAAM,M,oCAQuB,I,+IAmCP,K,CAZjC,MAAAC,GACE,OAAOC,KAAKC,kB,CAmBN,gBAAAA,GACN,GAAID,KAAKzC,YAAcyC,KAAKE,sBAAuB,CACjD,OACEC,EAAA,OACEC,IAAKJ,KAAKK,OAAS,GACnBC,MAAOhD,EAAIC,UACXgD,QAAS,IAAOP,KAAKE,sBAAwB,KAC7CM,IAAKR,KAAKzC,W,CAIhB,MAAME,EAAWuC,KAAKS,mBACtB,MAAMC,EAAkBV,KAAKW,oBAC7B,OACER,EAAA,qBACcH,KAAKK,OAASL,KAAKY,SAC/BN,MAAOhD,EAAIE,WACXqD,KAAK,SACLC,MAAO,CAAEJ,oBAERjD,EACC0C,EAAA,sBAAkB,OAAOG,MAAOhD,EAAIG,UACjCA,GAGH0C,EAAA,gBAAcG,MAAOhD,EAAII,KAAMA,KAAK,OAAOqD,MAAOf,KAAKe,Q,CASvD,iBAAAJ,GACN,MAAMK,OAAEA,EAAMC,SAAEA,EAAQL,SAAEA,EAAQM,GAAEA,GAAOlB,KAC3C,MAAMmB,EAAQC,EAAYF,GAC1B,MAAMG,EAAKL,GAAU,IAAIA,EAAO1C,OAAO0C,EAAOhD,OAAS,KACvD,MAAMsD,EAAOL,GAAYL,GAAY,GACrC,MAAM1C,EAAMmD,GAAME,EAAWF,GAAMA,EAAK1D,EAAY2D,GAEpD,IAAMN,IAAWM,IAAUC,EAAWrD,GAAM,CAC1C,MAAO,mC,CAET,MAAMsB,EAAME,EAASxB,GACrB,MAAMsD,EAAIL,IAAU,OAAS,GAAK,GAClC,MAAO,OAAO3B,WAAagC,K,CAMrB,gBAAAf,GACN,MAAMG,SAAEA,EAAQK,SAAEA,GAAajB,KAC/B,GAAIY,EAAU,CACZ,OAAOA,EACJa,OACA9C,MAAM,KACN+C,KAAKJ,GAASA,EAAKxC,UAAU,EAAG,KAChCD,KAAK,G,MACH,GAAIoC,EAAU,CACnB,OAAOA,EAASnC,UAAU,EAAG,E,CAE/B,OAAO,K"}